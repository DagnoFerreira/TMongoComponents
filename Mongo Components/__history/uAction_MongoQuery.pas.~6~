unit uAction_MongoQuery;

interface

uses
  FMX.ActnList, System.Actions, uMongoQuery, FMX.Forms, FMX.Layouts;

type
  TMongoInsert = class(TAction)
  private
    FMongoQuery : TMongoQuery;
    FLayout : TLayout;
  public
    function HandlesTarget(Target: TObject): Boolean; override;
    procedure UpdateTarget(Target: TObject); override;
    procedure ExecuteTarget(Target: TObject); override;
  published
    property MongoQuery : TMongoQuery read FMongoQuery write FMongoQuery;
    property Layout : TLayout read FLayout write FLayout;
  end;

  procedure Register;

implementation

procedure TMongoInsert.ExecuteTarget(Target: TObject);
var
  MongoQuery : TMongoQuery;
begin
  MongoQuery := TMongoQuery.Create(Self);
  try
    MongoQuery.InserirLayout(FLayout);
  finally
    MongoQuery.Free;
  end;
end;

function TMongoInsert.HandlesTarget(
  Target: TObject): Boolean;
begin
  Result := true;
  if not Result then
    Enabled := False;
end;

procedure TMongoInsert.UpdateTarget(Target: TObject);
begin
  Enabled := true;
end;

procedure Register;
begin
  RegisterActions('Mongo Components', [TMongoInsert], nil);
end;
end.

end.
